; Asterisk Extensions Configuration for AI Agent Outbound Calling
; This dialplan handles outbound calls through the AI agent

[globals]
; Global variables

[general]
static=yes
writeprotect=no
clearglobalvars=no

[outbound-calls]
; Main outbound calling context for AI agent

; Extension 's' - Start extension for outbound calls
exten => s,1,NoOp(AI Agent Outbound Call Starting)
    same => n,Set(CHANNEL(language)=de)
    same => n,Answer()
    same => n,Wait(1)
    ; Execute AGI script for AI agent
    same => n,AGI(/app/src/asterisk/call_handler.py)
    same => n,Hangup()

; Extension for manual testing
exten => 100,1,NoOp(Test Call)
    same => n,Answer()
    same => n,AGI(/app/src/asterisk/call_handler.py)
    same => n,Hangup()

; Transfer to human agent
exten => 200,1,NoOp(Transfer to Human Agent)
    same => n,Dial(SIP/agent@trunk,60)
    same => n,Voicemail(200@default,u)
    same => n,Hangup()

; Callback scheduling
exten => 300,1,NoOp(Schedule Callback)
    same => n,Set(CALLBACKNUM=${CALLERID(num)})
    same => n,System(echo "${CALLBACKNUM}" >> /app/callbacks.txt)
    same => n,Playback(callback-scheduled)
    same => n,Hangup()

[incoming]
; Handle incoming calls if needed
exten => _X.,1,NoOp(Incoming Call from ${CALLERID(num)})
    same => n,Answer()
    same => n,Wait(1)
    same => n,Playback(welcome)
    same => n,Hangup()
